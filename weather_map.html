<!DOCTYPE html>
<html>
<head>
    <title>AJAX Template</title>
</head>
<body>
<h1>Weather Application</h1>
<br>
<h3 id="location"></h3>
<div id="today"></div>
<div id="tomorrow"></div>
<div id="day-after"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="js/keys.js"></script>
<script src="js/skycons.js"></script>
<script>
    (() => {
        'use strict';
        $(document).ready(() => {
            var skycons = new Skycons({"color": "#DAF7A6"});
            const icons = [{clearday: Skycons.CLEAR_DAY}, {clearnight: Skycons.CLEAR_NIGHT}, {rain: Skycons.RAIN}, {snow: Skycons.SNOW}, {sleet: Skycons.SLEET}, {wind: Skycons.FOG}, {fog: Skycons.FOG}, {cloudy: Skycons.CLOUDY}, {partlycloudyday: Skycons.PARTLY_CLOUDY_DAY}, {partlycloudynight: Skycons.PARTLY_CLOUDY_NIGHT}]
            const getWeather = function () {
                $.ajax(`https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/${DARK_SKY_KEY}/29.4241,-98.4936`).done(function(data) {
                    let dailyDataArr = data['daily']['data']
                    for (let i = 0; i <= 2; i++) {
                        let summary = dailyDataArr[i]['summary'];
                        let icon = dailyDataArr[i]['icon'];
                        let high = Math.ceil(dailyDataArr[i]['temperatureHigh']);
                        let low = Math.ceil(dailyDataArr[i]['temperatureLow']);
                        let humidity = (dailyDataArr[i]['humidity']) * 100 + '%';
                        let wind = dailyDataArr[i]['windSpeed'];
                        let pressure = dailyDataArr[i]['pressure'];
                        if (i === 0) {
                            $('#today').html(`<ul id="today-ul"><li id="today-summary"> Weather Summary: ${summary}</li><li id="today-icon"><canvas id="icon1" width="128" height="128"></canvas>${icon}</li><li id="today-temps">Temperature: ${high}&deg; / ${low}&deg;</li><li id="today-humidity">Humidity: ${humidity}</li><li id="today-wind">Wind Speed: ${wind}</li><li id="today-pressure">Pressure: ${pressure}</li></ul>`)
                            skycons.add("icon1", Skycons.PARTLY_CLOUDY_DAY);
                            skycons.play();
                        } else if (i === 1) {
                            $('#tomorrow').html(`<ul id="tomorrow-ul"><li id="tomorrow-summary"> Weather Summary: ${summary}</li><li id="tomorrow-icon">${icon}</li><li id="tomorrow-temps">Temperature: ${high}&deg; / ${low}&deg;</li><li id="tomorrow-humidity">Humidity: ${humidity}</li><li id="tomorrow-wind">Wind Speed: ${wind}</li><li id="tomorrow-pressure">Pressure: ${pressure}</li></ul>`)
                        } else if (i === 2) {
                            $('#day-after').html(`<ul id="day-after-ul"><li id="day-after-summary"> Weather Summary: ${summary}</li><li id="day-after-icon">${icon}</li><li id="day-after-temps">Temperature: ${high}&deg; / ${low}&deg;</li><li id="day-after-humidity">Humidity: ${humidity}</li><li id="day-after-wind">Wind Speed: ${wind}</li><li id="day-after-pressure">Pressure: ${pressure}</li></ul>`)
                        } else {
                          console.log("error in getWeather");
                        }
                    }
                });
            }
            getWeather();

        });
    })();
</script>
</body>
</html>